<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>注册</title>
		<link rel="stylesheet" type="text/css" th:href="@{/css/public.css}"/>
		<link rel="stylesheet" type="text/css" th:href="@{/css/login.css}"/>
	</head>
	<body>
	<th:block th:include="webapp/link :: link"></th:block>
		<!-------------------reg-------------------------->
		<script th:src="@{/js/jquery-1.7.2.min.js}"></script>
		<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
		<div class="reg">
			<form action="reguserAdd.do" method="post" id="form">
				<h1><a href="index.html"><img src="/img/temp/logo.png"></a></h1>
				<h3>用户注册</h3>
				<p>带 *是必选项</p>
				<p>*<input type="text" name="username" value="" placeholder="请输入昵称" required></p>
				<p>*<input type="text" name="password" value="" placeholder="请输入密码"></p>
				<p>*<input type="text" name="repass" value="" placeholder="请确认密码"></p>
				<!--  <p class="txtL txt"><input class="code" type="text" name="" value="" placeholder="验证码"><img src="img/temp/code.jpg"></p>-->
				<p>*<input type="text" name="telephone" value="" placeholder="请输入电话号码"></p>
				<p><input type="datetime-local" name="birthday" value="" placeholder="请选择生日"></p>
				<input type="hidden" value="0" name="role">
				<p><input type="submit" name="" value="注册"></p>
				<p class="txtL txt">完成此注册，即表明您同意了我们的<a href="#"><使用条款和隐私策略></a></p>
				<p class="txt"><a href="/user/login"><span></span>已有账号登录</a></p>
				<!--<a href="#" class="off"><img src="img/temp/off.png"></a>-->
			</form>
		</div>
		<script>
			//一般直接写在一个js文件中
			layui.use('layer', function(){
				var layer = layui.layer;
			});
			//电话号码
			$.validator.addMethod("testTe",function(value,element,params){
				var reg = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
				if(reg.test(value))
					return true;
				return false;
			},"电话号码格式不正确");
			$().ready(function() {
			// 在键盘按下并释放及提交后验证提交表单
				$("#form").validate({
					rules: {
						username:{
							required: true,
							minlength: 3,

						},
						password: {
							required: true,
							minlength: 4,
							maxlength:16
						},
						repass: {
							required: true,
							minlength: 4,
							maxlength:16,
							equalTo:"input[name=password]"
						},
						telephone: {
							required: true,
							testTe: true
						},
					},
					messages: {
						username:{
							required: "用户名不能为空",
							minlength: "用户名不能少于三个",
						},
						password: {
							required: "密码不能为空",
							minlength: "密码最少输入四个",
							maxlength:"密码最多输入16个"
						},
						repass: {
							required: "确认密码不能为空",
							minlength: "确认密码最少输入四个",
							maxlength:"确认密码最多输入16个",
							equalTo:"两次密码输入不一致"
						},
						telephone: {
							required: "电话号码不能为空",
						},
					}
					,
					submitHandler:function(form){
						$.ajax(
								{
									url:"/user/reg",
									type:"POST",
									dataType:"json",
									data:$("#form").serialize(),
									success:function (result) {
										if(result.errorCode == 'success'){
											layer.alert(result.msg, {icon: 6});
										}
										if(result.errorCode == 'fail'){
											layer.alert(result.msg, {icon: 5});
										}
									}
								}
						)
				}
			})
			});
		</script>
	</body>
</html>
